{% load static %}
{% load extras %}
<!DOCTYPE html>
<html lang="en-US" data-theme='auto'>
    <head>
        <title>Batle Brothers Damage Calculator</title>
        {{ atkPresetJSON|json_script:"atkPresets" }}
        {{ defPresetJSON|json_script:"defPresets" }}
        {{ chartMetaJSON|json_script:"chartMeta" }}
        <script src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
        <script>
            const chartMeta = JSON.parse(document.getElementById('chartMeta').textContent)
            window.onload = function () {
                {% if request.HitChance %}
                const hits = "Swings"
                {% else %}
                const hits = "Hits"
                {% endif %}
                {% for k,v in results.ChartData.items %}
                    {% if k in chartMetaJSON %}
                    var NewChart = new CanvasJS.Chart(chartMeta.{{k}}.name, {
                        animationEnabled: true,
                        responsive: true,
                        title: {
                            text: hits + chartMeta.{{k}}.title
                        },
                        axisY: {
                            title: "Percent",
                            minimum: 0
                        },
                        axisX: {
                            title: "# of " + hits,
                        },
                        {% if chartType == "default" %}
                        data: [{
                            type: "column",
                            dataPoints: {{ v | safe }}
                        }]
                        {% else %}
                        toolTip: {
                            shared: true
                        },
                        data: [
                            {% for name, data in v.items %}
                            {
                                type: "{{ chartType }}",
                                name: "{{ name }}",
                                dataPoints: {{ data | safe }}
                            },
                            {% endfor %}
                        ]
                        {% endif %}
                    }); 
                    NewChart.render();
                    {% endif %}
                {% endfor %}
            }
        </script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Battle Brothers Damge Calculator">
        <meta name="keywords" content="Battle Brothers, Calculator">
        <meta name="google-site-verification" content="xwf1Th8eSui_5JP24GIGfOjzPi2fQEyaz1UMHhxI6oQ" />
        <link rel="stylesheet" href="{% static 'style.css' %}">
        <link rel="canonical" href="/">
        <link rel="icon" sizes="128x128" href="{% static 'favicon.ico' %}" type="image/ico">
        <link rel="apple-touch-icon" sizes="192x192" href="{% static 'apple-touch-icon.png' %}" type="image/png">
    </head>
    <body>
        <header class="container">
            <nav>
                <ul>
                    <li><a href="https://www.bbplanner.xyz/">Perk Planner</a></li>
                    <li><a href="https://battlebrothers.fandom.com/wiki/Battle_Brothers_Wiki">Wiki</a></li>
                    <li><a href="https://battlebrothersgame.com/">Forums</a></li>
                    <li><a href="https://old.reddit.com/r/BattleBrothers/">Reddit</a></li>
                    <li><a href="#" id="theme_switcher"></a></li>
                </ul>
            </nav>
            <hgroup>            
                <h1><a href="/">Battle Brothers Damage Calculator</a></h1>
                <p>Version 1.6.4, last updated August 8th, 2024.</p>
            </hgroup>
        </header>
        <main class="container">
            <form id="form" action="" method="get">
            <section id="AttackerSection" class="BackgroundSection">
                <details id="Attacker" {% if blank %} open {% endif %}>
                    <summary id="AttackerButton" class="SectionButton" role="button">Attacker</summary>
                    <div class="inner-container">
                        <h6>Preset</h6>
                            <select name="AtkPreset" id="AtkPreset">
                                <option value="None" {% if request.AtkPreset == "None" %} selected {% endif %}>None</option>
                                <option value="1Handers" class="atkBattery" {% if request.AtkPreset == "1Handers" %} selected {% endif %}>1 Hander Battery (22 weapon variants, remember to turn on double grip + duelist)</option>
                                <option value="2Handers" class="atkBattery" {% if request.AtkPreset == "2Handers" %} selected {% endif %}>2 Hander Battery (25 weapon variants)</option>
                                <option value="AllAtkPresets" class="atkBattery" {% if request.AtkPreset == "AllAtkPresets" %} selected {% endif %}>Attacker preset battery (all of the below presets)</option>
                                <option value="APreAncientSword" {% if request.AtkPreset == "APreAncientSword" %} selected {% endif %}>Ancient Dead w/ Ancient Sword</option>
                                <option value="APreBladedPike" {% if request.AtkPreset == "APreBladedPike" %} selected {% endif %}>Ancient Dead w/ Bladed Pike</option>
                                <option value="APreWarscytheAoE" {% if request.AtkPreset == "APreWarscytheAoE" %} selected {% endif %}>Ancient Dead w/ AoE Warscythe</option>
                                <option value="APreCryptCleaver" {% if request.AtkPreset == "APreCryptCleaver" %} selected {% endif %}>Ancient Dead w/ Crypt Cleaver</option>
                                <option value="APreKhopesh" {% if request.AtkPreset == "APreKhopesh" %} selected {% endif %}>Necrosavant w/ Khopesh</option>
                                <option value="APreFHGreatAxe" {% if request.AtkPreset == "APreFHGreatAxe" %} selected {% endif %}>Fallen Hero w/ Greataxe</option>
                                <option value="APreBerserkChain" {% if request.AtkPreset == "APreBerserkChain" %} selected {% endif %}>Orc Berserker w/ Berserk Chain</option>
                                <option value="APreHeadSplitter" {% if request.AtkPreset == "APreHeadSplitter" %} selected {% endif %}>Orc w/ Head Splitter</option>
                                <option value="APreHeadChopper" {% if request.AtkPreset == "APreHeadChopper" %} selected {% endif %}>Orc w/ Head Chopper</option>
                                <option value="APreMansplitter" {% if request.AtkPreset == "APreMansplitter" %} selected {% endif %}>Orc Warlord w/ Mansplitter</option>
                                <option value="APreReinBoondock" {% if request.AtkPreset == "APreReinBoondock" %} selected {% endif %}>Goblin Ambusher w/ Reinforced Boondock</option>
                                <option value="APreSpikedImpaler" {% if request.AtkPreset == "APreSpikedImpaler" %} selected {% endif %}>Goblin Overseer w/ Spiked Impaler</option>
                                <option value="APre2HSpikedMace" {% if request.AtkPreset == "APre2HSpikedMace" %} selected {% endif %}>Chosen w/ Spiked Mace</option>
                                <option value="APre2HSkullHammer" {% if request.AtkPreset == "APre2HSkullHammer" %} selected {% endif %}>Chosen w/ Skull Hammer</option>
                                <option value="APreHeavyRustyAxe" {% if request.AtkPreset == "APreHeavyRustyAxe" %} selected {% endif %}>Chosen w/ Rusty Axe</option>
                                <option value="APreRustyWarblade" {% if request.AtkPreset == "APreRustyWarblade" %} selected {% endif %}>Chosen w/ Rusty Warblade</option>
                                <option value="APreBillhook" {% if request.AtkPreset == "APreBillhook" %} selected {% endif %}>Billman w/ Billhook</option>
                                <option value="APreHeavyXbow" {% if request.AtkPreset == "APreHeavyXbow" %} selected {% endif %}>Arbalester w/ Heavy Xbow</option>
                                <option value="APreFightingAxe" {% if request.AtkPreset == "APreFightingAxe" %} selected {% endif %}>Knight w/ Fighting Axe</option>
                                <option value="APreWingedMace" {% if request.AtkPreset == "APreWingedMace" %} selected {% endif %}>Sergeant w/ Winged Mace</option>
                                <option value="APreGreatsword" {% if request.AtkPreset == "APreGreatsword" %} selected {% endif %}>Zweihander w/ Greatsword</option>
                                <option value="APreFlailDGrip" {% if request.AtkPreset == "APreFlailDGrip" %} selected {% endif %}>Raider w/ Double Gripped Flail</option>
                                <option value="APreLongAxe" {% if request.AtkPreset == "APreLongAxe" %} selected {% endif %}>Raider w/ Longaxe</option>
                                <option value="APreMedXbow" {% if request.AtkPreset == "APreMedXbow" %} selected {% endif %}>Marksman w/ Medium Xbow</option>
                                <option value="APreNobleSword" {% if request.AtkPreset == "APreNobleSword" %} selected {% endif %}>Swordmaster w/ Noble Sword</option>
                                <option value="APreWarbow" {% if request.AtkPreset == "APreWarbow" %} selected {% endif %}>Master Archer w/ Warbow</option>
                                <option value="APrePoleMace" {% if request.AtkPreset == "APrePoleMace" %} selected {% endif %}>Conscript w/ Polemace</option>
                                <option value="APreHandgonne" {% if request.AtkPreset == "APreHandgonne" %} selected {% endif %}>Gunner w/ Handgonne</option>
                                <option value="APre2HScimitar" {% if request.AtkPreset == "APre2HScimitar" %} selected {% endif %}>Officer w/ Scimitar</option>
                                <option value="APreQatal" {% if request.AtkPreset == "APreQatal" %} selected {% endif %}>Assassin w/ Qatal</option>
                                <option value="APreFDirewolf" {% if request.AtkPreset == "APreFDirewolf" %} selected {% endif %}>Frenzied Direwolf</option>
                                <option value="APreNachTier3" {% if request.AtkPreset == "APreNachTier3" %} selected {% endif %}>Tier 3 Nachzehrer</option>
                                <option value="APreLindwurm" {% if request.AtkPreset == "APreLindwurm" %} selected {% endif %}>Lindwurm Head</option>
                                <option value="APreUnhold" {% if request.AtkPreset == "APreUnhold" %} selected {% endif %}>Unhold</option>
                                <option value="APreSchrat" {% if request.AtkPreset == "APreSchrat" %} selected {% endif %}>Schrat</option>
                            </select>
                        <h6>Background</h6>
                            <select name="AtkBackground" id="AtkBackground">
                                <option value="None" {% if request.AtkBackground == "None" %} selected {% endif %}>None</option>
                                <option value="Juggler" {% if request.AtkBackground == "Juggler" %} selected {% endif %}>Juggler (+5% hit head chance)</option>
                                <option value="KillerOnTheRun" {% if request.AtkBackground == "KillerOnTheRun" %} selected {% endif %}>Killer on the Run (+10% hit head chance)</option>
                            </select>
                        <h6>Race</h6>
                            <select name="AtkRace" id="AtkRace">
                                <option id="atk-race-none" value="None" {% if request.AtkRace == "None" %} selected {% endif %}>None</option>
                                <option class="atk-race-selection" value="Young" {% if request.AtkRace == "Young" %} selected {% endif %}>Orc Young (+15% damage)</option>
                                <option class="atk-race-selection" value="Berserker" {% if request.AtkRace == "Berserker" %} selected {% endif %}>Orc Berserker (+20% damage)</option>
                                <option class="atk-race-selection" value="BerserkerDay190" {% if request.AtkRace == "BerserkerDay190" %} selected {% endif %}>Orc Berserker after day 190 (+30% damage)</option>
                                <option class="atk-race-selection" value="Warrior" {% if request.AtkRace == "Warrior" %} selected {% endif %}>Orc Warrior (+15% damage)</option>
                                <option class="atk-race-selection" value="WarriorDay200" {% if request.AtkRace == "WarriorDay200" %} selected {% endif %}>Orc Warrior after day 200 (+25% damage)</option>
                                <option class="atk-race-selection" value="Warlord" {% if request.AtkRace == "Warlord" %} selected {% endif %}>Orc Warlord (+35% damage)</option>
                                <option class="atk-race-selection" value="WarlordDay200" {% if request.AtkRace == "WarlordDay200" %} selected {% endif %}>Orc Warlord after day 200 (+45% damage)</option>
                                <option class="atk-race-selection" value="Conqueror" {% if request.AtkRace == "Conqueror" %} selected {% endif %}>Conqueror (+35% damage, Monolith)</option>
                                <option class="atk-race-selection" value="FallenBetrayer" {% if request.AtkRace == "FallenBetrayer" %} selected {% endif %}>Fallen Betrayer (+25% damage, Watermill)</option>
                                <option class="atk-race-selection" value="FallenHeroDay100" {% if request.AtkRace == "FallenHeroDay100" %} selected {% endif %}>Fallen Hero after day 100 (+10% damage)</option>
                                <option class="atk-race-selection" value="ArmoredZombieDay100" {% if request.AtkRace == "ArmoredZombieDay100" %} selected {% endif %}>Armored Zombie (+10% damage)</option>
                                <option class="atk-race-selection" value="BarbKing" {% if request.AtkRace == "BarbKing" %} selected {% endif %}>Barbarian King (+20% damage)</option>
                                <option class="atk-race-selection" value="HedgeKnight" {% if request.AtkRace == "HedgeKnight" %} selected {% endif %}>Hedge Knight (+20% damage)</option>
                                <option class="atk-race-selection" value="BrigandLeader" {% if request.AtkRace == "BrigandLeader" %} selected {% endif %}>Brigand Leader (+20% armor damage)</option>
                                <option class="atk-race-selection" value="MasterArcher" {% if request.AtkRace == "MasterArcher" %} selected {% endif %}>Master Archer (+25% armor ignore)</option>
                                <option class="atk-race-selection" value="Ambusher" {% if request.AtkRace == "Ambusher" %} selected {% endif %}>Goblin Ambusher (+25% armor ignore)</option>
                                <option class="atk-race-selection" value="AmbusherDay180" {% if request.AtkRace == "AmbusherDay180" %} selected {% endif %}>Goblin Ambusher after day 180 (+35% armor ignore)</option>
                                <option class="atk-race-selection" value="Skirmisher" {% if request.AtkRace == "Skirmisher" %} selected {% endif %}>Goblin Skirmisher (+25% armor ignore)</option>
                                <option class="atk-race-selection" value="Overseer" {% if request.AtkRace == "Overseer" %} selected {% endif %}>Goblin Overseer (+10% armor ignore)</option>
                                <option class="atk-race-selection" value="Wolfrider" {% if request.AtkRace == "Wolfrider" %} selected {% endif %}>Goblin Wolfrider (+25% armor ignore)</option>
                                <option class="atk-race-selection" value="FrenziedDirewolf" {% if request.AtkRace == "FrenziedDirewolf" %} selected {% endif %}>Frenzied Direwolf (+20% damage)</option>
                                <option class="atk-race-selection" value="UnholdDay90" {% if request.AtkRace == "UnholdDay90" %} selected {% endif %}>Unhold after day 90 (+10% damage)</option>
                                <option class="atk-race-selection" value="LindwurmDay170" {% if request.AtkRace == "LindwurmDay170" %} selected {% endif %}>Lindwurm after day 170 (+20% damage)</option>
                            </select>
                        <details id="AttackerStats">
                            <summary role="button" class="secondary">Stats</summary>
                            <fieldset class="grid">
                                <label class="StatLabel" for="Mind">Min Damage <img src="{% static 'icons/stats/damage_dealt.png' %}" alt="Damage dealt icon"></label>
                                <input class="atk-stat" type="number" name="Mind" id="Mind" min="1" max="999" value={{request.Mind|default:75}} required>
                                <label class="StatLabel" for="Maxd">Max Damage <img src="{% static 'icons/stats/damage_dealt.png' %}" alt="Damage dealt icon"></label>
                                <input class="atk-stat" type="number" name="Maxd" id="Maxd" min="1" max="999" value={{request.Maxd|default:95}} required>
                            </fieldset>
                            <fieldset class="grid">
                                <label class="StatLabel" for="Ignore">Armor Ignore % <img src="{% static 'icons/stats/direct_damage.png' %}" alt="Direct damage icon"></label>
                                <input class="atk-stat" type="number" name="Ignore" id="Ignore" min="0" max="999" value={{request.Ignore|default:50}} required>
                                <label class="StatLabel" for="ArmorMod">Armor Damage % <img src="{% static 'icons/stats/armor_damage.png' %}" alt="Armor damage icon"></label>
                                <input class="atk-stat" type="number" name="ArmorMod" id="ArmorMod" min="1" max="999" value={{request.ArmorMod|default:125}} required>
                            </fieldset>
                            <fieldset class="grid">
                                <label class="StatLabel" for="Headchance">% Chance to Hit Head <img src="{% static 'icons/stats/headchance.png' %}" alt="Headshot chance icon"></label>
                                <input class="atk-stat" type="number" name="Headchance" id="Headchance" min="0" max="100" value={{request.Headchance|default:25}} required>
                                <label class="StatLabel" for="Atk_Resolve">Resolve <img src="{% static 'icons/stats/resolve.png' %}" alt="Resolve icon"></label>
                                <input class="atk-stat" type="number" name="Atk_Resolve" id="Atk_Resolve" min="0" max="999" value={{request.Atk_Resolve|default:50}} required>
                            </fieldset>
                        </details>
                        <details id="AttackerWeapon">
                            <summary role="button" class="secondary">Weapon</summary>
                            <label for="DoubleGrip" title="Only 1Handers are valid for Double Grip. Dagger Puncture tests should not be given Double Grip.">
                                <input class="atk-checkbox" class="atk-checkbox" type="checkbox" name="AtkWeapon" id="DoubleGrip" value="DoubleGrip" {% if "DoubleGrip" in AtkWeapon%} checked {% endif %}>
                                <img src="{% static 'icons/weapon/doublegrip.png' %}" alt="Double grip icon"> Double Grip
                            </label>
                            <label for="TwoHander20" title="Damage +20. Applies to the single target 2Hander attacks Cudgel (Mace), Pound (Flail), Smite (Hammer), Overhead Strike (Long/Greatsword).">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="TwoHander20" value="TwoHander20" {% if "TwoHander20" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/overheadstrike.png' %}" alt="Overhead strike icon"> 2H Main Attack (+20 damage)
                            </label>
                            <label for="FlailLash" title="Gaurantees headshot. Also apply to 3Head Hail special.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="FlailLash" value="FlailLash" {% if "FlailLash" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/lash.png' %}" alt="Lash icon"> Flail Lash
                            </label>
                            <label for="Flail3Head" title="3Head Flail. Returns number of swings rather than number of hits.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Flail3Head" value="Flail3Head" {% if "Flail3Head" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/cascade.png' %}" alt="Cascade icon"> 3H Flail
                            </label>
                            <label for="Hammer10" title="Guarantees at least 10 hp damage, applies to 1H Hammer and Polehammer.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Hammer10" value="Hammer10" {% if "Hammer10" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/batter.png' %}" alt="Batter icon"> Hammer Batter (min 10 HP damage)
                            </label>
                            <label for="DestroyArmor" title="Will use Destroy Armor once and then switch to normal attacks.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="DestroyArmor" value="DestroyArmor" {% if "DestroyArmor" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/destroyarmor1.png' %}" alt="Destroy armor icon"> Destroy Armor
                            </label>
                            <label for="DestroyArmorMastery" title="Hammer Mastery. Will use Destroy Armor once and then switch to normal attacks.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="DestroyArmorMastery" value="DestroyArmorMastery" {% if "DestroyArmorMastery" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/hammermastery.png' %}" alt="Hammer mastery icon"> Destroy Armor Mastery
                            </label>
                            <label for="DestroyArmorTwice" title="Uses Destroy Armor two times instead of 1. Does nothing unless DestroyArmor or DestroyArmorMastery are set.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="DestroyArmorTwice" value="DestroyArmorTwice" {% if "DestroyArmorTwice" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/destroyarmor2.png' %}" alt="Destroy armor icon"> Destroy Armor Twice
                            </label>
                            <label for="Axe1H" title="Applies bonus damage to Headshots. Negated by Steel Brow.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Axe1H" value="Axe1H" {% if "Axe1H" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/chop.png' %}" alt="Chop icon"> 1H Axe
                            </label>
                            <label for="SplitMan" title="Applies to single target 2HAxe except for Longaxe.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="SplitMan" value="SplitMan" {% if "SplitMan" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/splitman.png' %}" alt="Split man icon"> Split Man
                            </label>
                            <label for="AoE2HAxe" title="Applies to Round Swing and Split in Two (Bardiche), reduces Ignore by 10%.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="AoE2HAxe" value="AoE2HAxe" {% if "AoE2HAxe" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/roundswing.png' %}" alt="Round swing icon"> 2H Axe AoE
                            </label>
                            <label for="CleaverBleed" title="5 bleed damage per bleed tick.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="CleaverBleed" value="CleaverBleed" {% if "CleaverBleed" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/cleave.png' %}" alt="Cleave icon"> Cleaver Bleed
                            </label>
                            <label for="CleaverMastery" title="10 bleed damage per bleed tick.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="CleaverMastery" value="CleaverMastery" {% if "CleaverMastery" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/cleavermastery.png' %}" alt="Cleaver mastery icon"> Cleaver Mastery
                            </label>
                            <label for="Decapitate" title="Cleaver Decapitate. Will use Decapitate for all attacks.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Decapitate" value="Decapitate" {% if "Decapitate" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/decapitate.png' %}" alt="Decapitate icon"> Decapitate
                            </label>
                            <label for="SmartDecap50" title="Switches from normal Cleaver attacks to Decapitate once opposing hp is &lt;= 50%.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="SmartDecap50" value="SmartDecap50" {% if "SmartDecap50" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/decapitate.png' %}" alt="Decapitate icon"> Decapitate &lt;50% HP
                            </label>
                            <label for="SmartDecap33" title="Switches from normal Cleaver attacks to Decapitate once opposing hp is &lt;= 33.33%">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="SmartDecap33" value="SmartDecap33" {% if "SmartDecap33" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/decapitate.png' %}" alt="Decapitate icon"> Decapitate &lt;33% HP
                            </label>
                            <label for="Shamshir" title="Shamshir special Gash, acts like Crippling Strikes.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Shamshir" value="Shamshir" {% if "Shamshir" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/gash.png' %}" alt="Gash icon"> Shamshir Gash
                            </label>
                            <label for="ShamshirMastery" title="Sword Mastery with Gash, 50% reduction to injury threshold instead of 33%. Overrides Shamshir flag.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="ShamshirMastery" value="ShamshirMastery" {% if "ShamshirMastery" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/swordmastery.png' %}" alt="Sword mastery icon"> Shamshir Mastery
                            </label>
                            <label for="Sword2HSplit" title="Ignore +5%. Applies to Greatsword Split attack. Does not apply to Overhead or Swing.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Sword2HSplit" value="Sword2HSplit" {% if "Sword2HSplit" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/split.png' %}" alt="Split icon"> Greatsword Split
                            </label>
                            <label for="Puncture" title="Dagger Puncture. Do not apply Double Grip.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Puncture" value="Puncture" {% if "Puncture" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/puncture.png' %}" alt="Puncture icon"> Puncture
                            </label>
                            <label for="Deathblow" title="Qatal special. Ignore +20%. Damage x1.33. Assumes target is always setup for Deathblow value in calculation.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Deathblow" value="Deathblow" {% if "Deathblow" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/deathblow.png' %}" alt="Deathblow icon"> Deathblow
                            </label>
                            <label for="Spearwall" title="Warning: May take a long time to compute against durable targets, consider lowering number of trials.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Spearwall" value="Spearwall" {% if "Spearwall" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/spearwall.png' %}" alt="Spearwall icon"> Spearwall
                            </label>
                            <label for="AimedShot" title="Damage +10% for Bows. +5% Armor Ignore.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="AimedShot" value="AimedShot" {% if "AimedShot" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/aimedshot.png' %}" alt="Aimed shot icon"> Aimed Shot
                            </label>
                            <label for="XbowMastery" title="+20% Armor Ignore.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="XbowMastery" value="XbowMastery" {% if "XbowMastery" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/crossbowmastery.png' %}" alt="Crossbow mastery icon"> Crossbow Mastery
                            </label>
                            <label for="R2Throw" title="Throwing Mastery for 1 or 2 Range.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="R2Throw" value="R2Throw" {% if "R2Throw" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/throwingmastery.png' %}" alt="Throwing mastery icon"> Throwing Mastery (range 2)
                            </label>
                            <label for="R3Throw" title="Throwing Mastery for 3 Range.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="R3Throw" value="R3Throw" {% if "R3Throw" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/throwingmastery.png' %}" alt="Throwing mastery icon"> Throwing Mastery (range 3)
                            </label>
                            <label for="Scatter" title="Ranged attacks that hit an unintended target deal 75% damage.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Scatter" value="Scatter" {% if "Scatter" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/quickshot.png' %}" alt="Quick shot icon"> Scatter
                            </label>
                            <label for="Pierce" title="-50% health damage for Daggers, Spears, and Pikes against Ancient Dead, Alps, and Ifrits.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Pierce" value="Pierce" {% if "Pierce" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/impale.png' %}" alt="Impale icon"> Piercing (-50% health damage vs skeletons/alps/ifrits)
                            </label>
                            <label for="DogBite" title="-66% health damage for Dog bites against Alps.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="DogBite" value="DogBite" {% if "DogBite" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/dogbite.png' %}" alt="Dog bite icon"> Dog bite (-66% health damage vs alps)
                            </label>
                            <label for="XbowOrSling" title="-66% health damage for Xbows and Slings against Ancient Dead, Alps, and Ifrits.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="XbowOrSling" value="XbowOrSling" {% if "XbowOrSling" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/shootbolt.png' %}" alt="Shoot bolt icon"> Xbow/Sling (-66% health damage vs skeletons/alps/ifrits)
                            </label>
                            <label for="Handgonne" title="-66% health damage for Handgonnes against Ancient Dead, -50% against Alps, and -75% against Ifrits.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Handgonne" value="Handgonne" {% if "Handgonne" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/firehandgonne.png' %}" alt="Fire handgonne icon"> Handgonne (-50% health damage vs alps, -66% vs skeletons, -75% vs ifrits)
                            </label>
                            <label for="Javelin" title="-75% health damage for Javelins against Ancient Dead, Alps, and Ifrits.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Javelin" value="Javelin" {% if "Javelin" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/throwjavelin.png' %}" alt="Throw javelin icon"> Javelin (-75% health damage vs skeletons/alps/ifrits)
                            </label>
                            <label for="Ignite" title="-75% health damage for Ignite against Ancient Dead, -90% against Ifrits.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Ignite" value="Ignite" {% if "Ignite" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/ignite.png' %}" alt="Ignite icon"> Ignite (-75% health damage vs skeletons, -90% vs ifrits)
                            </label>
                            <label for="Arrow" title="-90% health damage for Bows against Ancient Dead, Alps, and Ifrits.">
                                <input class="atk-checkbox" type="checkbox" name="AtkWeapon" id="Arrow" value="Arrow" {% if "Arrow" in AtkWeapon %} checked {% endif %}>
                                <img src="{% static 'icons/weapon/quickshot.png' %}" alt="Quick shot icon"> Bow (-90% health damage vs skeletons/alps/ifrits)
                            </label>
                        </details>
                        <details id="AttackerPerks">
                            <summary role="button" class="secondary">Perks</summary>
                            <label for="FastAdaptation">
                                <input class="atk-checkbox" type="checkbox" name="AtkPerks" id="FastAdaptation" value="FastAdaptation" {% if "FastAdaptation" in AtkPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/fastadaptation.png' %}" alt="Fast adaptation icon"> Fast Adaptation (use only with hit chance)
                            </label>
                            <label for="CripplingStrikes">
                                <input class="atk-checkbox" type="checkbox" name="AtkPerks" id="CripplingStrikes" value="CripplingStrikes" {% if "CripplingStrikes" in AtkPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/cripplingstrikes.png' %}" alt="Crippling strikes icon"> Crippling Strikes
                            </label>
                            <label for="Executioner">
                                <input class="atk-checkbox" type="checkbox" name="AtkPerks" id="Executioner" value="Executioner" {% if "Executioner" in AtkPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/executioner.png' %}" alt="Executioner icon"> Executioner
                            </label>
                            <label for="HeadHunter">
                                <input class="atk-checkbox" type="checkbox" name="AtkPerks" id="HeadHunter" value="HeadHunter" {% if "HeadHunter" in AtkPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/headhunter.png' %}" alt="Head hunter icon"> Head Hunter
                            </label>
                            <label for="Duelist">
                                <input class="atk-checkbox" type="checkbox" name="AtkPerks" id="Duelist" value="Duelist" {% if "Duelist" in AtkPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/duelist.png' %}" alt="Duelist icon"> Duelist
                            </label>
                            <label for="KillingFrenzy">
                                <input class="atk-checkbox" type="checkbox" name="AtkPerks" id="KillingFrenzy" value="KillingFrenzy" {% if "KillingFrenzy" in AtkPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/killingfrenzy.png' %}" alt="Killing frenzy icon"> Killing Frenzy
                            </label>
                            <label for="Fearsome">
                                <input class="atk-checkbox" type="checkbox" name="AtkPerks" id="Fearsome" value="Fearsome" {% if "Fearsome" in AtkPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/fearsome.png' %}" alt="Fearsome icon"> Fearsome
                            </label>
                        </details>
                        <details id="AttackerTraits">
                            <summary role="button" class="secondary">Traits</summary>
                            <label for="Brute">
                                <input type="checkbox" name="AtkTraits" id="Brute" value="Brute" {% if "Brute" in AtkTraits %} checked {% endif %}>
                                <img src="{% static 'icons/traits/brute.png' %}" alt="Brute icon"> Brute (+15% headshot damage)
                            </label>
                            <label for="Drunkard">
                                <input type="checkbox" name="AtkTraits" id="Drunkard" value="Drunkard" {% if "Drunkard" in AtkTraits %} checked {% endif %}>
                                <img src="{% static 'icons/traits/drunkard.png' %}" alt="Drunkard icon"> Drunkard (+10% damage)
                            </label>
                            <label for="Huge">
                                <input type="checkbox" name="AtkTraits" id="Huge" value="Huge" {% if "Huge" in AtkTraits %} checked {% endif %}>
                                <img src="{% static 'icons/traits/huge.png' %}" alt="Huge icon"> Huge (+10% damage)
                            </label>
                            <label for="Tiny">
                                <input type="checkbox" name="AtkTraits" id="Tiny" value="Tiny" {% if "Tiny" in AtkTraits %} checked {% endif %}>
                                <img src="{% static 'icons/traits/tiny.png' %}" alt="Tiny icon"> Tiny (-15% damage)
                            </label>
                        </details>
                        <details id="AttackerInjuries">
                            <summary role="button" class="secondary">Injuries</summary>
                            <label for="BrokenArm">
                                <input type="checkbox" name="AtkInjuries" id="BrokenArm" value="BrokenArm" {% if "BrokenArm" in AtkInjuries %} checked {% endif %}>
                                <img src="{% static 'icons/injuries/brokenarm.png' %}" alt="Broken arm icon"> Broken Arm (-50% damage)
                            </label>
                            <label for="SplitShoulder">
                                <input type="checkbox" name="AtkInjuries" id="SplitShoulder" value="SplitShoulder" {% if "SplitShoulder" in AtkInjuries %} checked {% endif %}>
                                <img src="{% static 'icons/injuries/splitshoulder.png' %}" alt="Split shoulder icon"> Split Shoulder (-50% damage)
                            </label>
                            <label for="CutArmSinew">
                                <input type="checkbox" name="AtkInjuries" id="CutArmSinew" value="CutArmSinew" {% if "CutArmSinew" in AtkInjuries %} checked {% endif %}>
                                <img src="{% static 'icons/injuries/cutarmsinew.png' %}" alt="Cut arm sinew icon"> Cut Arm Sinew (-40% damage)
                            </label>
                            <label for="InjuredShoulder">
                                <input type="checkbox" name="AtkInjuries" id="InjuredShoulder" value="InjuredShoulder" {% if "InjuredShoulder" in AtkInjuries %} checked {% endif %}>
                                <img src="{% static 'icons/injuries/injuredshoulder.png' %}" alt="Injured shoulder icon"> Injured Shoulder (-25% damage)
                            </label>
                        </details>
                        <details id="AttackerStatus">
                            <summary role="button" class="secondary">Status Effects</summary>
                            <label for="Dazed">
                                <input type="checkbox" name="AtkStatus" id="Dazed" value="Dazed" {% if "Dazed" in AtkStatus %} checked {% endif %}>
                                <img src="{% static 'icons/status/dazed.png' %}" alt="Dazed icon"> Dazed (-25% damage)
                            </label>
                            <label for="Distracted">
                                <input type="checkbox" name="AtkStatus" id="Distracted" value="Distracted" {% if "Distracted" in AtkStatus %} checked {% endif %}>
                                <img src="{% static 'icons/status/distracted.png' %}" alt="Distracted icon"> Distracted (-35% damage, from Nomads)
                            </label>
                            <label for="Mushrooms">
                                <input type="checkbox" name="AtkStatus" id="Mushrooms" value="Mushrooms" {% if "Mushrooms" in AtkStatus %} checked {% endif %}>
                                <img src="{% static 'icons/status/mushrooms.png' %}" alt="Strange mushrooms icon"> Strange Mushrooms (+25% damage)
                            </label>
                        </details>
                    </div>
                </details>
            </section>
            <section id="DefenderSection" class="BackgroundSection">
                <details id="Defender" {% if blank %} open {% endif %}>
                    <summary id="DefenderButton" class="SectionButton" role="button">Defender</summary>
                    <div class="inner-container">
                        <h6>Preset</h6>
                            <select name="DefPreset" id="DefPreset">
                                <option value="None" {% if request.DefPreset == "None" %} selected {% endif %}>None</option>
                                <option value="NimbleBattery" class="defBattery" {% if request.DefPreset == "NimbleBattery" %} selected {% endif %}>Nimble battery (15 nimble variations, remember to turn on nimble)</option>
                                <option value="AllDefPresets" class="defBattery" {% if request.DefPreset == "AllDefPresets" %} selected {% endif %}>Defender preset battery (all of the below presets)</option>
                                <option value="DPreNimbleBro" {% if request.DefPreset == "DPreNimbleBro" %} selected {% endif %}>120hp, 120/95, Nimble Bro</option>
                                <option value="DPreNimbleBroBP" {% if request.DefPreset == "DPreNimbleBroBP" %} selected {% endif %}>120hp, 120/95, Nimble, Bone Plates Bro</option>
                                <option value="DPreForgeBro" {% if request.DefPreset == "DPreForgeBro" %} selected {% endif %}>80hp, 300/300, Forge Bro</option>
                                <option value="DPreForgeBroAFP" {% if request.DefPreset == "DPreForgeBroAFP" %} selected {% endif %}>80hp, 300/300, Forge, Additional Fur Padding Bro</option>
                                <option value="DPreAncientLegion" {% if request.DefPreset == "DPreAncientLegion" %} selected {% endif %}>Ancient Legionary</option>
                                <option value="DPreHonorGuard" {% if request.DefPreset == "DPreHonorGuard" %} selected {% endif %}>Honor Guard</option>
                                <option value="DPreArmGangerHeavy" {% if request.DefPreset == "DPreArmGangerHeavy" %} selected {% endif %}>Heavy Armored Weiderganger</option>
                                <option value="DPreFHeroHeavy" {% if request.DefPreset == "DPreFHeroHeavy" %} selected {% endif %}>Heavy Fallen Hero</option>
                                <option value="DPreYoungHeavy" {% if request.DefPreset == "DPreYoungHeavy" %} selected {% endif %}>Heavy Orc Young</option>
                                <option value="DPreBerserkerHeavy" {% if request.DefPreset == "DPreBerserkerHeavy" %} selected {% endif %}>Heavy Orc Berserker</option>
                                <option value="DPreWarriorLight" {% if request.DefPreset == "DPreWarriorLight" %} selected {% endif %}>Light Orc Warrior</option>
                                <option value="DPreWarriorHeavy" {% if request.DefPreset == "DPreWarriorHeavy" %} selected {% endif %}>Heavy Orc Warrior</option>
                                <option value="DPreWarlord" {% if request.DefPreset == "DPreWarlord" %} selected {% endif %}>Orc Warlord</option>
                                <option value="DPreSkirmisherHeavy" {% if request.DefPreset == "DPreSkirmisherHeavy" %} selected {% endif %}>Heavy Goblin Skirmisher</option>
                                <option value="DPreAmbusher" {% if request.DefPreset == "DPreAmbusher" %} selected {% endif %}>Goblin Ambusher</option>
                                <option value="DPreShaman" {% if request.DefPreset == "DPreShaman" %} selected {% endif %}>Goblin Shaman</option>
                                <option value="DPreOverseer" {% if request.DefPreset == "DPreOverseer" %} selected {% endif %}>Goblin Overseer</option>
                                <option value="DPreReaverHeavy" {% if request.DefPreset == "DPreReaverHeavy" %} selected {% endif %}>Heavy Barbarian Reaver</option>
                                <option value="DPreChosenLight" {% if request.DefPreset == "DPreChosenLight" %} selected {% endif %}>Light Barbarian Chosen</option>
                                <option value="DPreChosenHeavy" {% if request.DefPreset == "DPreChosenHeavy" %} selected {% endif %}>Heavy Barbarian Chosen</option>
                                <option value="DPreBarbKing" {% if request.DefPreset == "DPreBarbKing" %} selected {% endif %}>Barbarian King</option>
                                <option value="DPreBeastmaster" {% if request.DefPreset == "DPreBeastmaster" %} selected {% endif %}>Barbarian Beastmaster</option>
                                <option value="DPreFootmanHeavy" {% if request.DefPreset == "DPreFootmanHeavy" %} selected {% endif %}>Heavy Footman</option>
                                <option value="DPreBillman" {% if request.DefPreset == "DPreBillman" %} selected {% endif %}>Billman</option>
                                <option value="DPreArbalester" {% if request.DefPreset == "DPreArbalester" %} selected {% endif %}>Arbalester</option>
                                <option value="DPreBannerHeavy" {% if request.DefPreset == "DPreBannerHeavy" %} selected {% endif %}>Heavy Bannerman</option>
                                <option value="DPreKnight" {% if request.DefPreset == "DPreKnight" %} selected {% endif %}>Knight</option>
                                <option value="DPreSergeant" {% if request.DefPreset == "DPreSergeant" %} selected {% endif %}>Sergeant</option>
                                <option value="DPreZweiHeavy" {% if request.DefPreset == "DPreZweiHeavy" %} selected {% endif %}>Heavy Zweihander</option>
                                <option value="DPreRaiderHeavy" {% if request.DefPreset == "DPreRaiderHeavy" %} selected {% endif %}>Heavy Brigand Raider</option>
                                <option value="DPreMarkman" {% if request.DefPreset == "DPreMarkman" %} selected {% endif %}>Brigand Marksman</option>
                                <option value="DPreLeaderHeavy" {% if request.DefPreset == "DPreLeaderHeavy" %} selected {% endif %}>Heavy Brigand Leader</option>
                                <option value="DPreMercenaryHeavy" {% if request.DefPreset == "DPreMercenaryHeavy" %} selected {% endif %}>Heavy Mercenary</option>
                                <option value="DPreMercRange" {% if request.DefPreset == "DPreMercRange" %} selected {% endif %}>Ranged Mercenary</option>
                                <option value="DPreHedgeKnight" {% if request.DefPreset == "DPreHedgeKnight" %} selected {% endif %}>Hedge Knight</option>
                                <option value="DPreSwordmaster" {% if request.DefPreset == "DPreSwordmaster" %} selected {% endif %}>Swordmaster</option>
                                <option value="DPreMasterArcher" {% if request.DefPreset == "DPreMasterArcher" %} selected {% endif %}>Master Archer</option>
                                <option value="DPreOutlawHeavy" {% if request.DefPreset == "DPreOutlawHeavy" %} selected {% endif %}>Heavy Brigand Outlaw</option>
                                <option value="DPreConscript" {% if request.DefPreset == "DPreConscript" %} selected {% endif %}>Conscript</option>
                                <option value="DPreOfficer" {% if request.DefPreset == "DPreOfficer" %} selected {% endif %}>Officer</option>
                                <option value="DPreAssassinHeavy" {% if request.DefPreset == "DPreAssassinHeavy" %} selected {% endif %}>Heavy Assassin</option>
                            </select>
                        <h6>Armor Attachment</h6>
                            <small>IMPORTANT: Attachments will automatically add armor or subtract Fatigue. Use the base armor/Fatigue values in the Defender Stats section or else you will double dip the attachment.</small>
                            <select name="ArmorAttachment" id="ArmorAttachment">
                                <option id="def-attachment-none" value="None" {% if request.ArmorAttachment == "None" %} selected {% endif %}>None</option>
                                <option class="def-attachment-selection" value="Wolf_Hyena" title="+15 armor." {% if request.ArmorAttachment == "Wolf_Hyena" %} selected {% endif %}>Wolf/Hyena Pelt</option>
                                <option class="def-attachment-selection" value="LindwurmCloak" title="+60 armor, -3 Fatigue." {% if request.ArmorAttachment == "LindwurmCloak" %} selected {% endif %}>Lindwurm Cloak</option>
                                <option class="def-attachment-selection" value="AdFurPad" title="33% reduced armor ignoring damage. -2 Fatigue." {% if request.ArmorAttachment == "AdFurPad" %} selected {% endif %}>Additional Fur Padding</option>
                                <option class="def-attachment-selection" value="Boneplate" title="Absorbs first body hit. -2 Fatigue." {% if request.ArmorAttachment == "Boneplate" %} selected {% endif %}>Bone Platings</option>
                                <option class="def-attachment-selection" value="HornPlate" title="Only select against melee attacks. +30 armor, 10% damage reduction." {% if request.ArmorAttachment == "HornPlate" %} selected {% endif %}>Horn Plate</option>
                                <option class="def-attachment-selection" value="UnholdFurCloak" title="Only select against range attacks. +10 armor, 20% damage reduction." {% if request.ArmorAttachment == "UnholdFurCloak" %} selected {% endif %}>Unhold Fur Cloak</option>
                                <option class="def-attachment-selection" value="SerpentSkin" title="Only select in Handgonne tests. +30 armor, -2 Fatigue, 33% damage reduction." {% if request.ArmorAttachment == "SerpentSkin" %} selected {% endif %}>Serpent Skin</option>
                            </select>
                        <h6>Race</h6>
                            <select name="DefRace" id="DefRace">
                                <option id="def-race-none" value="None" {% if request.DefRace == "None" %} selected {% endif %}>None</option>
                                <option class="def-race-selection" value="Zombie" {% if request.DefRace == "Zombie" %} selected {% endif %}>Zombie (Immunity to Injury, Bleeding, Poison, and Morale)</option>
                                <option class="def-race-selection" value="Savant" {% if request.DefRace == "Savant" %} selected {% endif %}>Savant (Immunity to Injury and Morale)</option>
                                <option class="def-race-selection" value="Skeleton" {% if request.DefRace == "Skeleton" %} selected {% endif %}>Skeleton (Zombie immunities + damage reduction vs certain weapons)</option>
                                <option class="def-race-selection" value="Alp" {% if request.DefRace == "Alp" %} selected {% endif %}>Alp (Immunity to Injury, Bleeding, and Poison + damage reduction vs certain weapons)</option>
                                <option class="def-race-selection" value="Ifrit" {% if request.DefRace == "Ifrit" %} selected {% endif %}>Ifrit (Zombie immunities + damage reduction vs certain weapons)</option>
                                <option class="def-race-selection" value="PossessedUndead" {% if request.DefRace == "PossessedUndead" %} selected {% endif %}>Possessed (Zombie immunities + 25% damage reduction, Necromancer buff)</option>
                                <option class="def-race-selection" value="FallenBetrayerD" {% if request.DefRace == "FallenBetrayerD" %} selected {% endif %}>Fallen Betrayer (Zombie immunities + 25% armor damage reduction, Watermill)</option>
                            </select>
                        <details>
                            <summary role="button" class="secondary">Stats</summary>
                            <fieldset class="grid">
                                <label class="StatLabel" for="Def_HP">Health <img src="{% static 'icons/stats/health.png' %}" alt="Health icon"></label>
                                <input class="def-stat" type="number" name="Def_HP" id="Def_HP" min="1" max="500" value={{request.Def_HP|default:100}} required>
                                <label class="StatLabel" for="Def_Helmet">Helmet Armor <img src="{% static 'icons/stats/helmetarmor.png' %}" alt="Helmet armor icon"></label>
                                <input class="def-stat" type="number" name="Def_Helmet" id="Def_Helmet" min="0" max="500" value={{request.Def_Helmet|default:120}} required>
                            </fieldset>
                            <fieldset class="grid">
                                <label class="StatLabel" for="Def_Armor">Body Armor <img src="{% static 'icons/stats/bodyarmor.png' %}" alt="Body armor icon"></label>
                                <input class="def-stat" type="number" name="Def_Armor" id="Def_Armor" min="0" max="500" value={{request.Def_Armor|default:95}} required>
                                <label class="StatLabel" for="Fatigue" title="Only affects nimble.">Armor Fatigue Penalty <img src="{% static 'icons/stats/fatigue.png' %}" alt="Fatigue icon"></label>
                                <input class="def-stat" type="number" name="Fatigue" id="Fatigue" min="-50" max="0" value={{request.Fatigue|default:-15}} required>
                            </fieldset>
                            <fieldset>
                                <label class="StatLabel" for="Def_Resolve" title="Used only if morale drop data returns are enabled.">Resolve <img src="{% static 'icons/stats/resolve.png' %}" alt="Resolve icon"></label>
                                <input class="def-stat" type="number" name="Def_Resolve" id="Def_Resolve" min="0" max="999" value={{request.Def_Resolve|default:70}} required>
                            </fieldset>
                        </details>
                        <details>
                            <summary role="button" class="secondary">Perks</summary>
                            <label for="NineLives">
                                <input class="def-checkbox" type="checkbox" name="DefPerks" id="NineLives" value="NineLives" {% if "NineLives" in DefPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/ninelives.png' %}" alt="9 lives icon"> 9 Lives
                            </label>
                            <label for="Resilient">
                                <input class="def-checkbox" type="checkbox" name="DefPerks" id="Resilient" value="Resilient" {% if "Resilient" in DefPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/resilient.png' %}" alt="Resilient icon"> Resilient
                            </label>
                            <label for="SteelBrow">
                                <input class="def-checkbox" type="checkbox" name="DefPerks" id="SteelBrow" value="SteelBrow" {% if "SteelBrow" in DefPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/steelbrow.png' %}" alt="Steel brow icon"> Steel Brow
                            </label>
                            <label for="Nimble">
                                <input class="def-checkbox" type="checkbox" name="DefPerks" id="Nimble" value="Nimble" {% if "Nimble" in DefPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/nimble.png' %}" alt="Nimble icon"> Nimble
                            </label>
                            <label for="Forge">
                                <input class="def-checkbox" type="checkbox" name="DefPerks" id="Forge" value="Forge" {% if "Forge" in DefPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/battleforged.png' %}" alt="Battleforged icon"> Battleforged
                            </label>
                            <label for="Indomitable">
                                <input class="def-checkbox" type="checkbox" name="DefPerks" id="Indomitable" value="Indomitable" {% if "Indomitable" in DefPerks %} checked {% endif %}>
                                <img src="{% static 'icons/perks/indomitable.png' %}" alt="Indomitable icon"> Indomitable
                            </label>
                        </details>
                        <details>
                            <summary role="button" class="secondary">Traits</summary>
                            <label for="Ironjaw">
                                <input type="checkbox" name="DefTraits" id="Ironjaw" value="Ironjaw" {% if "Ironjaw" in DefTraits %} checked {% endif %}>
                                <img src="{% static 'icons/traits/ironjaw.png' %}" alt="Iron jaw icon"> Iron Jaw
                            </label>
                            <label for="GloriousEndurance">
                                <input type="checkbox" name="DefTraits" id="GloriousEndurance" value="GloriousEndurance" {% if "GloriousEndurance" in DefTraits %} checked {% endif %}>
                                <img src="{% static 'icons/traits/gloriousendurance.png' %}" alt="Glorious endurance icon"> Glorious Endurance (Bear)
                            </label>
                        </details>
                    </div>
                </details>
            </section>
            <section id="ResultsSection" class="BackgroundSection">
                <details id="Results" {% if not blank %} open {% endif %}>
                    <summary id="ResultsButton" class="SectionButton" role="button">Results</summary>
                    <div class="inner-container">
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="DeathMean" value="DeathMean" {% if "DeathMean" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.DeathMean|linebreaksbr|default:"Returns the average number of hits until death." }}</samp>
                            </label>
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="DeathStDev" value="DeathStDev" {% if "DeathStDev" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.DeathStDev|linebreaksbr|default:"Returns standard deviation of hits until death." }}</samp>
                            </label>
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="DeathPercent" value="DeathPercent" {% if "DeathPercent" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.DeathPercent|linebreaksbr|default:"Returns % chance of death by each hit." }}</samp>
                            </label>
                            {% if "DeathPercent" in DataReturns and "HitsToDeathPercent" in results.ChartData%}
                            <div class="canvas-container">
                                <div id="DeathPercentChart" class="canvas"></div>
                            </div>
                            {% endif %}
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="InjuryMean" value="InjuryMean" {% if "InjuryMean" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.InjuryMean|linebreaksbr|default:"Returns average number of hits until first injury." }}</samp>
                            </label>
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="InjuryPercent" value="InjuryPercent" {% if "InjuryPercent" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.InjuryPercent|linebreaksbr|default:"Returns % chance of first injury by each hit." }}</samp>
                            </label>
                            {% if "InjuryPercent" in DataReturns and "HitsToInjurePercent" in results.ChartData%}
                            <div class="canvas-container">
                                <div id="InjuryPercentChart" class="canvas"></div>
                            </div>
                            {% endif %}
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="HeavyInjuryMean" value="HeavyInjuryMean" {% if "HeavyInjuryMean" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.HeavyInjuryMean|linebreaksbr|default:"Returns average number of hits until chance of first heavy injury (heavy injuries are not guaranteed even when threshold is met)." }}</samp>
                            </label>
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="HeavyInjuryPercent" value="HeavyInjuryPercent" {% if "HeavyInjuryPercent" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.HeavyInjuryPercent|linebreaksbr|default:"Returns % chance of first heavy injury chance by each hit." }}</samp>
                            </label>
                            {% if "HeavyInjuryPercent" in DataReturns and "HitsToHeavyInjuryChancePercent" in results.ChartData%}
                            <div class="canvas-container">
                                <div id="HeavyInjuryPercentChart" class="canvas"></div>
                            </div>
                            {% endif %}
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="MoraleChecksTotal" value="MoraleChecksTotal" {% if "MoraleChecksTotal" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.MoraleChecksTotal|linebreaksbr|default:"Returns the total number of morale checks before death." }}</samp>
                            </label>
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="MoraleMean" value="MoraleMean" {% if "MoraleMean" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.MoraleMean|linebreaksbr|default:"Returns average number of hits until first morale check." }}</samp>
                            </label>
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="MoralePercent" value="MoralePercent" {% if "MoralePercent" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.MoralePercent|linebreaksbr|default:"Returns % chance of first morale check by each hit." }}</samp>
                            </label>
                            {% if "MoralePercent" in DataReturns and "HitsToMoralePercent" in results.ChartData%}
                            <div class="canvas-container">
                                <div id="MoralePercentChart" class="canvas"></div>
                            </div>
                            {% endif %}
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="MoraleDropsMean" value="MoraleDropsMean" {% if "MoraleDropsMean" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.MoraleDropsMean|linebreaksbr|default:"Returns average number of hits to drop morale to each morale level." }}</samp>
                            </label>
                        </div>
                        <div class="result-container">
                            <label>
                                <input type="checkbox" name="DataReturns" id="MoraleDropsPercent" value="MoraleDropsPercent" {% if "MoraleDropsPercent" in DataReturns %} checked {% endif %}>
                                <samp>{{ results.MoraleDropsPercent|linebreaksbr|default:"Returns % chance of dropping morale to each morale level by each hit." }}</samp>
                            </label>
                            {% if "MoraleDropsPercent" in DataReturns%}
                                {% if "HitsToWaveringPercent" in results.ChartData%}
                                <div class="canvas-container">
                                    <div id="HitsToWaveringChart" class="canvas"></div>
                                </div>
                                {% endif %}
                                {% if "HitsToBreakingPercent" in results.ChartData%}
                                <div class="canvas-container">
                                    <div id="HitsToBreakingChart" class="canvas"></div>
                                </div>
                                {% endif %}
                                {% if "HitsToFleeingPercent" in results.ChartData%}
                                <div class="canvas-container">
                                    <div id="HitsToFleeingChart" class="canvas"></div>
                                </div>
                                {% endif %}
                            {% endif %}
                        </div>
                        <div class="result-container">
                            <samp>{{ results.Nimble|linebreaksbr|default:"Returns % damage modifier from nimble." }}</samp>
                        </div>
                        <div class="result-container">
                            <samp>{{ results.Forge|linebreaksbr|default:"Returns bonus armor from battleforged." }}</samp>
                        </div>
                        <div class="result-container">
                            <samp>{{ results.Ambusher|linebreaksbr|default:"Returns average number of hits until poisoned (Goblin Ambusher only)." }}</samp>
                        </div>
                        <div class="result-container">
                            <samp>{{ results.Cleaver|linebreaksbr|default:"Returns average number of hits until bleeding." }}</samp>
                        </div>
                    </div>
                </details>
            </section>
            <section id="CalculateSection">
                <label for="HitChance"><h6>Hit chance</h6></label>
                If left blank, the calculator will assume every swing hits.
                <input type="number" name="HitChance" id="HitChance" min="5" max="95" value={{request.HitChance|default:"''"}} placeholder="Enter a whole number">
                <label for="Trials"><h6># of trials</h6></label>
                <fieldset role="group">
                    <input type="number" name="Trials" id="Trials" min="2" max="10000" value={{request.Trials|default:1000}} required>
                    <input type="submit" value="Calculate">
                </fieldset>
                <div id="progress-wrapper">
                    <progress id="progress" class="invisible" data-battery='false'></progress>
                    <p id="progress-label" class="invisible"></p>
                </div>
            </section>
            <input type="number" name="pID" id="pID" value = {{ pID }}>
            </form>
        </main>
        <footer>
            <div class="inner-container">
                <small>
                    <div>
                        <h6>Credits</h6>
                        <ul>
                            <li>Calculator author: turtle225</li>
                            <li>Site author: osgboy</li>
                        </ul>
                    </div>
                    <div>
                        <h6>Contact</h6>
                        <ul>
                            <li>turtle225: <a href="mailto:turtl225e@gmail.com">turtl225e@gmail.com</a></li>
                            <li>osgboy: message me <a href="https://old.reddit.com/user/Osgboy">Reddit</a> or on the <a href="https://discord.gg/s4Va2Nxhb4">Overhype</a> or <a href="https://discord.gg/P7PXCBwfwC">Battle Brothers</a> Discord</li>
                        </ul>
                    </div>
                    <div>
                        <h6>Special Thanks</h6>
                        <ul>
                            <li>Abel (aka) Villain Joueur: For grabbing the damage formula out of the game code, writing the damage page on the wiki, and for helping me with many questions along the way.</li>
                            <li>Wall (aka) Wlira: For helping me with some questions along the way and having an existing calculator for me to test against.</li>
                            <li>You: If you are using the calculator, thank you! If you find any bugs or have feedback/questions/suggestions, you can usually find me on the Steam forums or send me an email.</li>
                            <li>Overhype: For making an amazing game for us to play.</li>
                        </ul>
                    </div>
                    <hr>
                    <div class="copyright">
                        Copyright &copy; 2019-2024, turtle225. All rights reserved.
                    </div>
                </small>
            </div>
        </footer>
        <script src="{% static 'presets.js' %}"></script>
        <script>
            let stored = sessionStorage.getItem('theme')
            if (stored == 'dark') {
                var isLight = false;
            } else {
                var isLight = true;
            }
            const html = document.documentElement
            const switchTheme = document.getElementById('theme_switcher')
            const os_default = '<svg viewBox="0 0 16 16"><path fill="currentColor" d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"/></svg>'
            const sun = '<svg viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a3 3 0 1 1 0-6a3 3 0 0 1 0 6zm0 1a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/></svg>'
            const moon = '<svg viewBox="0 0 16 16"><g fill="currentColor"><path d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278zM4.858 1.311A7.269 7.269 0 0 0 1.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316 0 0 0 5.205-2.162c-.337.042-.68.063-1.029.063c-4.61 0-8.343-3.714-8.343-8.29c0-1.167.242-2.278.681-3.286z"/><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></g></svg>'
            
            document.addEventListener('DOMContentLoaded', () => {
                if (stored == null) {
                    switchTheme.innerHTML = os_default
                    switchTheme.setAttribute('data-tooltip', 'OS theme')
                    switchTheme.focus()
                    removeTooltip()
                } else {
                    html.setAttribute('data-theme', isLight? 'light':'dark')
                    switchTheme.innerHTML = isLight? sun : moon
                    switchTheme.setAttribute('data-tooltip', `${isLight?'light':'dark'} theme`)
                }
            })
            switchTheme.addEventListener('click', (e)=> {
                e.preventDefault()
                isLight = !isLight
                html.setAttribute('data-theme', isLight? 'light':'dark')
                switchTheme.innerHTML = isLight? sun : moon
                switchTheme.setAttribute('data-tooltip', `${isLight?'Light':'Dark'} theme`)
                sessionStorage.setItem('theme', isLight? 'light':'dark')
                removeTooltip()
            })
            const removeTooltip = (timeInt = 1500) => {
                setTimeout(()=>{
                    switchTheme.blur()
                },timeInt)
            }
        </script>
        <script>
            const progressUrl = '{% url "progress_status" pID %}';
            const form = document.getElementById("form");
            const progressLabel = document.getElementById("progress-label");
            
            form.addEventListener("submit", updateProgress);
            
            function updateProgress () {
                progressBar.classList.remove("invisible")
                if (progressBar.getAttribute('data-battery') == 'true') {
                    // progressLabel.classList.remove("invisible")
                    fetch(progressUrl).then(function(response) {
                        response.json().then(function(data) {
                            // update the appropriate UI components
                            // progressBar.setAttribute('value', data.progress);
                            // progressBar.setAttribute('max', data.max_progress);
                            // progressLabel.innerHTML = data.progress + " of " + data.max_progress + " processed.";
                            // console.log(progressLabel.innerHTML);
                            // setTimeout(updateProgress, 200);
                        });
                    });
                }
            }
        </script>
    </body>
</html>